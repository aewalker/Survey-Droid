<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=us-ascii">
	<title>PEOPLES Project Overview</title>
	
	<style type="text/css">
		.done {color: green;}
		.partial {color: blue;}
		.failed {color: red;}
	</style>
</head>

<body>
<table border="0" cellpadding="5" cellspacing="0" width="100%">
	<tbody>
		<tr>
			<td valign="top"><img src="http://www.cs.princeton.edu/pulogo.gif" height="90" width="80">
				<h5>
					<a href="http://www.princeton.edu/">Princeton University</a><br />
					<a href="http://www.cs.princeton.edu/">Computer Science Department</a>
				</h5>
			</td>
			<td align="center" valign="middle">
				<h2>
					Computer Science 333<br />
					Advanced Programming Techniques<br />
					PEOPLES Project Overview Document<br />
				</h2>
			</td>
			<td align="right" valign="middle">
				<h3>Spring 2011</h3>
			</td>
		</tr>
	</tbody>
</table>

<!-- =============================================================== -->

<h2>Project Name: PEOPLES</h2>
<p>
	<strong>P</strong>EOPLES
	<strong>E</strong>nables the
	<strong>O</strong>bservation of
	<strong>P</strong>opulations
	<strong>L</strong>iving in
	<strong>E</strong>veryday
	<strong>S</strong>ociety
</p>

<p><strong>Team Members:</strong></p>
<table cellpadding="10" style="text-align: center">
	<tr>
		<td>Sema Berkiten</td>
		<td>Vladimir Costescu</td>
		<td>Henry Liu</td>
		<td>Austin Walker</td>
		<td>Tony Xaio</td>
		<td>Diego Vargas</td>
	</tr>
	<tr>
		<td><a href="mailto:berkiten@princeton.edu">berkiten@</a></td>
		<td><a href="mailto:costescu@princeton.edu">costescu@</a></td>
		<td><a href="mailto:henryliu@princeton.edu">henryliu@</a></td>
		<td><a href="mailto:aewalker@princeton.edu">aewalker@</a></td>
		<td><a href="mailto:tonyx@princeton.edu">tonyx@</a></td>
		<td><a href="mailto:dvargas@princeton.edu">dvargas@</a></td>
	</tr>
</table>

<p><strong>Team Leader:</strong> Diego Vargas</p>

<hr />

<!-- =============================================================== -->

<h3>Overview</h3>
<p>As described in our Elevator Speech, PEOPLES is a tool for social science research. Primarily the application will provide the functionality needed by Naomi F. Sugie's project. Briefly, those features are:</p>
<ul>
	<li>
		GPS and cell tower-based location tracking
	</li>
	<li>
		Phone call information gathering:
		<ul>
			<li>Call data is anonymous to protect researchers from legal trouble</li>
			<li>Researchers can see the exact times calls are made and the type of call</li>
		</ul>
	</li>
	<li>
		Surveys:
		<ul>
			<li>Surveys are administered on a weekly time table; each survey can be set to display any number of specific times during the week</li>
			<li>Surveys can be very powerful via the ability to adapt to previous responses</li>
			<li>Surveys work outside of cell/internet coverage to prevent gaps in data</li>
		</ul>
	</li>
</ul>

<p>Additionally, we will provide a web-based portal to allow researchers to interact with the phone applications. The main features of the site will allow researchers to:
<ul>
	<li>Design and modify surveys</li>
	<li>Monitor subject participation</li>
	<li>Download collected data</li>
</ul>
The website is written in PHP using the open-source framework CakePHP, which requires no special server modules beyond those that come with Apache. This ensures that just about any server can be set up with a copy of the site without any new third-party software.</p>

<p>Though PEOPLES is being created for a particular project, we intend to for it to outlive the current study and allow other researchers to use the application in a different context.</p>

<p>There are two previous examples of projects using smart-phone applications in Social Science research:</p>
<ul>
	<li>
		The Human Mobility Project
		<ul>
			<li>Princeton University researchers developed an android application to allow location tracking and survey deployment. We have access to the codebase as well	as the coders from whom to get advice. The code will not be reused, we will be building from zero but will emphasize good design to allow reuse.</li>
		</ul>
	</li>
	
	<li>
		The Reality Mining project
		<ul>
			<li>MIT researchers designed an application to track the social interactions of smart phone users. The application was designed for the Nokia 6600.</li>
		</ul>
	</li>
</ul>

<p>Our project most closely resembles the HMP, and we have already received some input regarding the challenges they faced. We are aiming for an improved application with additional features, including survey modifications, battery life monitoring, web-portal application management, and others discussed in the appropriate section.</p>

<hr />

<!--Reqs  -->

<h3>Requirements</h3>

<p>There are two user groups of our application, the researchers and the study subjects. For each of the user groups there is a primary interface with which they will interact.</p>

<p>Through the web portal, researchers will be able to interact with their research project. In preparation for the study, researchers will be able to set various parameters on the data that will be gathered from the study participants. These parameters will include times of location tracking, phone call information to be collected, and the design and modification of surveys pushed to participants. As the study is being conducted the portal will allow researchers to monitor subject participation, to access participant data, and to export the information so that it can be processed further. </p>

<p>The Android phone application will be the primary means through which study participants will be followed throughout the study. The application will enable location tracking at specific hours, will track different outgoing and incoming phone numbers, and will present surveys to be completed by the participant. The application will allow the users to turn on/off features they may not want at any given time. Surveys need to be interactive, and may change based on the responses from previous surveys or the current survey. The UI needs to be clear, intuitive, and out of the way. The application will need to monitor the battery life of the phone and be active or inactive depending on the level.</p>

<p>Lastly, there may be some overlap between the Web Interface and the phone interface. Researchers may collect some data from the subjects that may affect data collection. For example, participants may be asked for names of family members that will later be displayed on the surveys. Part of the web portal should ease the difficulty of gathering information from 100 subject participants and making custom surveys for each.</p>

<p>In short, our application will have two main components, a web based portal for researchers, and the Android application for study participants. The overlap, as well as the specific functions of each component will allow researchers to more easily collect data that was previously difficult to gather.</p>

<hr />

<!--Func  -->

<h3>Functionality</h3>

<h4>Researchers - Implement Survey</h4>

<p>User arrives at the index page, and enters his/her username and password. From the main screen, the "Surveys" button brings the user to a list of all surveys with the option to edit or delete an existing survey, or add a new one.  The survey editing page will allow the user to write questions and answers, as well as define the control flow of the survey and set when it should be displayed to subjects.</p>

<h4>Researchers - Access Data</h4>

<p>The application automatically collects data from all subjects including their locations, phone calls, and survey responses.  This information is cached on the phone until it is sent to the server.  At that point, web users can view data related to a specific subject and export data as comma separated values.</p>

<h4>Researchers - Notifications</h4>

<p>If subjects keep certain aspects of the applications disabled for an extended period of time, then users will receive a notification email consisting of the subject's number, which aspect(s) has been disabled, and for long how it(they) has been disabled. The consequences that follow are left for the users to decide.</p>

<h4>Subjects - Complete Survey</h4>

<p>Users will receive a small, unobtrusive notification whenever a survey is ready to be taken. User must then navigate to the phone application. There, the user can take the survey via the phone's touchscreen and keyboard.  Only one question is displayed at a time since future questions can depend on past questions. If at any point, the user terminates the application to do something else (ie. answer a call, send a text message, etc) answers will be saved up to the question where the user left off. If however, the phone is turned off, or the application is disabled, user will lose all unsubmitted survey data. Warning messages will be implemented to prevent this from happening.</p>

<h4>Subjects - Disable Application</h4>

<p>Users will be given complete instructions on how to disable this application.  When they receive their phones. To disable the application, user goes to the application options menu, located at the bottom on the application pane. From there, user may choose to enable/disable various aspects of the application, including the minor notifications, the use of the GPS module, or even a global disable. If user keeps the application disabled for an extended period of time, they will receive a notification, and if he/she refuses to comply, the researchers are notified.</p>

<hr />

<!--Design -->

<h3>Design</h3>

<h4>Database</h4>

<p>We will use MySQL for the web-database, but will design Phone and Web applications as independent from any particular database as possible. We anticipate the following tables and attributes:</p>

<ul>
<li>users (the web users - researchers)
	<ul>	
		<li>id</li>
		<li>username</li>
		<li>email</li>
		<li>password</li>
		<li>first_name</li>
		<li>last_name</li>
		<li>admin (typically the project leader will be an admin)</li>
	</ul>
</li>
	
<li>subjects (the phone users)
	<ul>
		<li>id</li>
		<li>phone_num</li>
		<li>first_name</li>
		<li>last_name</li>
	</ul>
</li>
	
<li>surveys
	<ul>
		<li>id</li>
		<li>name</li>
		<li>created</li>
		<li>starting_question</li>
		<li>mo (fields to track when a survey should be administered)</li>
		<li>tu</li>
		<li>we</li>
		<li>th</li>
		<li>fr</li>
		<li>sa</li>
		<li>su</li>
	</ul>
</li>
	
<li>questions (survey questions)
	<ul>
		<li>id</li>
		<li>survey_id (survey that this question is part of)</li>
		<li>text</li>
	</ul>
</li>
	
<li>branches (branches dictate control flow in a survey)
	<ul>
		<li>id</li>
		<li>previous_question</li>
		<li>next_question</li>
	</ul>
</li>
	
<li>conditions (conditions belong to branches; in order to follow a branch all its conditions must be true)
	<ul>
		<li>id</li>
		<li>branch_id</li>
		<li>question_id (the question to look at)</li>
		<li>choice_id (the answer to the above question that must have been given for this condition to be true)</li>
		<li>type (determine whether to look at questions in this survey or in all past surveys)</li>
	</ul>
</li>
	
<li>choices (choices are the options a subject can pick from when answering a question; a question with no choices is free-response)
	<ul>
		<li>id</li>
		<li>choice_text</li>
		<li>question_id</li>
	</ul>
</li>
	
<li>answers (keeps track of subjects' survey answers)
	<ul>
		<li>id</li>
		<li>question_id</li>
		<li>subject_id</li>
		<li>choice_id (null if free-response question)</li>
		<li>ans_text (null if multiple-choice question)</li>
		<li>created</li>
	</ul>
</li>
	
<li>locations (GPS location data)
	<ul>
		<li>id</li>
		<li>subject_id</li>
		<li>created</li>
		<li>longitude</li>
		<li>latitude</li>
	</ul>
</li>
	
<li>calls (call log information)
	<ul>
		<li>id </li>
		<li>contact_id (unique number generated in place of a phone number)</li>
		<li>subject_id</li>
		<li>created</li>
		<li>type (call made, call received, missed call, etc.)</li>
		<li>duration</li>
	</ul>
</li>
</ul>

<p>In addition, each phone will have a SQLite database running to cache logged data (calls, survey answers, and GPS data) and hold surveys.  This enables the application to function for extended periods of time without cell or internet coverage and still display surveys.</p>

<h4>Phone Application</h4>

<p>We will develop for Android in Java using Google's Android API version 7 targeted at Android version 2.1 (specifically, for the Samsung Intercept phones that Naomi will be using), though we hope to design our app so that it can be easily used with newer versions of Android.  The major components of the phone app are:</p>
<ol>
	<li>Data Collection: this component will be responsible for collecting GPS and calling data and holding it until it can be sent to the server.  This is where we anticipate the most differences between different versions of Android will be, so we must be careful to encapsulate as much version-specific code as possible in this section.</li>
	<li>Server Communication: this component is responsible for communicating information from other components to the server and communicating responses back.  We will try to encapsulate most of the MySQL specific code here so the app can easily be adapted to other database engines.</li>
	<li>User Interface: this component is responsible for allowing the user to respond to surveys and power the app or parts of it on and off.</li>
</ol>

<p>
	Here are the latest updates on the Phone application design:
	<a href="https://docs.google.com/document/pub?id=12AqD6qyfr94OVOdn3HBiAqdpq4WLnYdaQ_aUxXznK1U">Google doc notes</a>
</p>

<h4>Web Application</h4>

<p>
	We will use PHP to write the web portal side of our project. We will be using the PHP web framework
	<a href=http://www.cakephp.org/>CakePHP</a> (version 1.3)
	in order to keep our code more structured and make development easier. The major components of the web application will be:
</p>
<ol>
	<li>Users Component: deals with logging in users, setting up their preferences, and allows admins to register new users.</li>
	<li>Survey Control Component: allows the web users to create and configure surveys to send out to the phones.</li>
	<li>Data View Component: allows viewing of the data collected from study participant's phones. Also allows this data to be exported for use in other applications.</li>
	<li>Subjects Control Component: handles the set up and management of survey participants.</li>
	<li>Communication Component: enables the phone to pull surveys and push subject data.</li>
</ol>
<p>All communication between the phone and the web server will be initiated by the phone in order to account for situations where the phone does not have a reliable connection (the phone only contacts the web server if it has a reliable connection).</p>

<hr />

<!-- Milestones  -->

<h3>Milestones</h3>

Meetings with Naomi will take place on the following dates: 3/21, 4/6, 4/18, 5/2, 5/9

<h4>Milestones</h4>
<div class="done" style="display:inline">Completed </div><div class="partial" style="display:inline">Partial/Delayed </div><div class="failed" style="display:inline">Failed</div>
<ul>
	<li>
		By 3/20 (end of Spring Break)
		<ul>
			<li class="partial">All team members running the proper development software (see development section)</li>
			<li class="done">Testing/development server is running and has Apache, PHP, and MySQL installed</li>
			<li class="partial">All team members have SSH access to the server</li>
			<li class="done">Decide on whether or not to use a web-application framework and what one</li>
			<li class="done">Server is tested in a simple way to ensure that all required technologies are working</li>
			<li class="partial">Divide up work between team members</li>
			<li class="partial">Set up GitHub account and give all team members access</li>
		</ul>
	</li>
	<li>3/21 - First Meeting with Naomi - team receives testing phones</li>
	<li>
		By 3/27
		<ul>
			<li class="done">Database is set up and operational</li>
			<li class="partial">Specific requirements of each component of both the phone app and the web app are specified</li>
			<li class="done">Team splits off to work on individual assignments</li>
		</ul>
	</li>
	<li>
		By 4/5 (Prototype)
		<ul>
			<li class="done">Finish users and subjects in the web app</li>
			<li class="done">Phone app collects GPS data</li>
		</ul>
	</li>
	<li>
		By 4/12
		<ul>
			<li class="done">Finish surveys in the web app</li>
			<li class="done">Phone app collects call data</li>
		</ul>
	</li>
	<li>
		By 4/19 (Alpha version)
		<ul>
			<li class="done">Finish communication between the phone and the web server</li>
			<li class="done">Preliminary user interface complete on phone app</li>
			<li class="done">Finish data view/export in web app</li>
			<li class="failed">Phone builds survey objects from database (moved to beta version)</li>
		</ul>
	</li>
	<li>
		By 4/26 (Beta version)
		<ul>
			<li class="done">CSS/graphics complete on web app</li>
			<li>
				Bugs fixed and user interfaces polished:
				<ul><li class="done">web interface</li><li>phone interface</li></ul>
			</li>
			<li>Phone app can be turned on/off</li>
			<li>GPS and call data are reported to web server</li>
			<li class="done">Phone builds survey objects from database, administers them, and saves results.</li>
			<li>Survey results on phone are uploaded to server.</li>
		</ul>
	</li>
	<li>
		By 5/3 (Presentation and final version)
		<ul>
			<li>Extensive testing completed on:<ul><li>phone</li><li>website</li></ul></li>
		</ul>
	</li>
	<li>
		By 5/10 (Dean's Date)
		<ul>
			<li>User's guide, design document, source code, presentation slides, and final report finished</li>
		</ul>
	</li>
</ul>

<hr />

<!-- Risks and open issues -->

<h3>Risks and Open Issues</h3>

<p>None of us are experienced on open source Android application, so we need to learn Android development environment initially. Also because we don't know so much about Android and we don't work with anyone who is expert or experienced on Android applications, we could face with something very difficult or impossible to implement. For example, there is a possibility of unavailable functions on phone API. Furthermore, compatibility is another issue. Our application might be used on lots of different devices with different hardware, that is why we may need to write different drivers for different devices. And while doing this, we might face with some quirks because we don't know differences between various versions of Android.</p>

<p>Hosting is an open issue, for now we decided to use a temporary server but in the long run we need to find a permanent server. And during server transfer, we might face with some problems that we cannot predict now and it could be very complicated.  In addition to the live test server, Austin and Sema have set up locally running Apache servers to test code without committing it to GitHub first.</p>

<p>In addition to the phone application, we will also design a web-portal for researchers such that they can have some amount of control over the application. <del>However it is still an open issue if we will use PHP, Java or something else as server-side web language. Just two of team members know PHP and if we decide to move on with PHP then other team members would have to learn PHP.</del> We have decided to go with PHP, but we decided that the phone app would be more work so only 2 people will be working on the website: Austin and Sema (both know PHP).</p>

<p>Finally, evaluation of usability and success of this application could be nontrivial. For now, giving users a survey seems to be one option for evaluation, but it may be better to find a more reliable way to evaluate the application.</p>

<hr />

<p align="right"><small>Page based on COS333 class website template</small></p>

<hr />

</body>
</html>
